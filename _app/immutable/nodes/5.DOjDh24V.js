import{e as yt,j as kt,s as ft,r as Lt,b as jt}from"../chunks/2bZPbiiR.js";import{t as p,a as h,c as Pt}from"../chunks/DdyhVRrO.js";import{i as Yt}from"../chunks/BeYxgMet.js";import{T as r,g as t,m as f,a,U as s,V as $,a5 as Xt,Q as At,f as mt,R as Dt,s as c,aA as Ht}from"../chunks/DDwyxSy3.js";import{h as It,s as Y}from"../chunks/DUDkuhxp.js";import{i as q}from"../chunks/Dx_FE2Yb.js";import{k as Rt,s as zt}from"../chunks/CTt7uVht.js";import{e as R}from"../chunks/CzTI-ryX.js";import{b as gt}from"../chunks/BtKBGxqQ.js";import{p as ot}from"../chunks/0eAcf9mX.js";import{g as Kt}from"../chunks/BFg-vgtH.js";import{H as Tt}from"../chunks/D6_0TWwu.js";import{M as Wt}from"../chunks/j_NvyHS2.js";const Ct=!0;async function Et({params:F}){const{id:_}=F;console.log(_);let H=[];return _=="daily"?(console.log("daily"),H=await yt("images")):H=await kt(_),{images:H,id:_}}const ce=Object.freeze(Object.defineProperty({__proto__:null,load:Et,prerender:Ct},Symbol.toStringTag,{value:"Module"}));var Ft=p('<div class="w-full h-full overflow-hidden rounded-lg flex justify-center items-center" role="group"><img alt="pilt" class="rounded-lg w-auto h-auto max-w-full max-h-full object-contain"></div>');function St(F,_){let H=ot(_,"source",8),n=f(),z=0,y=0,v=f(1),X=0,I=0,k=0,x=0,g=f(0),b=f(0),A=!1;function K(){t(n)&&(z=t(n).naturalWidth,y=t(n).naturalHeight)}function m(l){l.preventDefault(),a(v,t(v)+l.deltaY*-.005),a(v,Math.min(Math.max(1,t(v)),3)),B()}function Z(l){l.preventDefault(),A=!0,X=l.clientX,I=l.clientY,k=t(g),x=t(b)}function tt(l){if(A){const w=(l.clientX-X)/t(v),C=(l.clientY-I)/t(v);a(g,k+w),a(b,x+C),B()}}function T(l){A=!1}function B(){if(!t(n))return;const l=z*t(v),w=y*t(v),C=Math.max(0,(l-z)/2),O=Math.max(0,(w-y)/2),i=l>z?-C:0,j=w>y?-O:0;a(g,Math.max(i,Math.min(C,t(g)))),a(b,Math.max(j,Math.min(O,t(b))))}var L=Ft(),W=r(L),et=Xt(K);gt(W,l=>a(n,l),()=>t(n)),s(L),$(()=>{ft(W,"src",H()),ft(W,"style",`transform: scale(${t(v)??""}) translate(${t(g)??""}px, ${t(b)??""}px);`)}),R("load",W,function(...l){var w;(w=t(et))==null||w.apply(this,l)}),R("wheel",L,m),R("mousedown",L,Z),R("mousemove",L,tt),R("mouseup",L,T),h(F,L)}var qt=p('<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="">'),Bt=p('<div class="w-full h-96 flex items-center justify-center mb-4"><!></div>'),Ot=p('<div class="w-full h-1/4"><p class="mb-4"> </p> <p class="text-xs"> </p></div>'),Qt=p('<div class="flex gap-4 mb-4"><div class="w-24 h-fit"><h1 class="text-3xl"> </h1></div> <input type="range" min="1890" max="2025" class="w-full svelte-9gxx18" id="year-select"></div>'),Ut=p('<div class="mb-4"><h3> </h3> <div class="flex flex-col md:flex-row md:gap-4 mb-4"><h3> </h3> <h3> </h3></div> <div class="flex flex-col gap-4 md:flex-row justify-between"><div class="flex gap-2"><h3>Kaugus:</h3> <div class="h-fit w-12 p-.5 bg-white text-[#1e272e] flex justify-center rounded-md"> </div></div> <div class="flex gap-2"><h3>Aastaarv:</h3> <div class="h-fit w-12 p-.5 bg-white text-[#1e272e] flex justify-center rounded-md"> </div></div> <div class="flex gap-2"><h3>Kokku:</h3> <div class="h-fit w-12 p-.5 bg-white text-[#1e272e] flex justify-center rounded-md"> </div></div></div></div>'),Vt=p('<button class="cursor-not-allowed bg-gray-700 svelte-9gxx18">Vali asukoht</button>'),Gt=p('<button class="border border-2 hover:bg-white hover:text-[#1e272e] cursor-pointer svelte-9gxx18">Arva</button>'),Jt=p('<button class="border border-2 hover:bg-white hover:text-[#1e272e] cursor-pointer svelte-9gxx18">Edasi</button>'),Nt=p('<div class="flex md:flex-row flex-col w-full h-full"><div class="w-full md:w-1/2 px-6 py-2"><!> <!></div> <div class="w-full md:w-1/2 px-6 py-2"><!> <!> <div class="w-full h-fit flex justify-end"><!></div></div></div>'),$t=p("<!> <!>",1);function fe(F,_){At(_,!1);let H=ot(_,"data",8),{images:n,id:z}=H(),y=f(),v=f(null),X=f(null),I=f(null),k=f(1950),x=f(!1),g=f(null),b=f(null),A=f(null),K=ot(_,"totalPoints",12,0),m=f(1);function Z(){a(x,!0),a(I,[n[t(m)-1].latitude,n[t(m)-1].longitude]),t(y).makeGuess(),a(g,tt(t(v).getLatLng().lat,t(v).getLatLng().lng,t(X).getLatLng().lat,t(X).getLatLng().lng)),a(g,Math.round(t(g)*100)/100),a(b,et(Math.abs(t(k)-n[t(m)-1].year))),a(A,W(t(g))),K(K()+(t(b)+t(A)))}function tt(i,j,E,Q){var at=6371,U=T(E-i),S=T(Q-j),V=T(i),G=T(E),J=Math.sin(U/2)*Math.sin(U/2)+Math.sin(S/2)*Math.sin(S/2)*Math.cos(V)*Math.cos(G),rt=2*Math.atan2(Math.sqrt(J),Math.sqrt(1-J)),N=at*rt;return N}function T(i){return i*Math.PI/180}function B(){a(x,!1),a(X,null),a(I,null),a(v,null),a(g,null),a(k,1950),Ht(m)}function L(){t(y).advance(),t(m)==n.length?(zt.set(K()),Kt(`/leaderboard/${z}`)):B()}function W(i){return i-1>0?i>100?0:Math.round(5e3-(i-1)*50):5e3}function et(i){return i>50?0:5e3-i*100}Yt();var l=$t();It(i=>{var j=qt();h(i,j)});var w=mt(l);Tt(w,{get points(){return K()},get counter(){return t(m)},get maxRounds(){return n.length}});var C=c(w,2);{var O=i=>{var j=Nt(),E=r(j),Q=r(E);Rt(Q,()=>t(m),e=>{var o=Bt(),u=r(o);St(u,{get source(){return n[t(m)-1].image_path}}),s(o),h(e,o)});var at=c(Q,2);{var U=e=>{var o=Ot(),u=r(o),D=r(u,!0);s(u);var M=c(u,2),d=r(M,!0);s(M),s(o),$(()=>{Y(D,n[t(m)-1].description),Y(d,n[t(m)-1].attribution)}),h(e,o)};q(at,e=>{t(x)&&e(U)})}s(E);var S=c(E,2),V=r(S);gt(Wt(V,{get marker(){return t(v)},set marker(e){a(v,e)},get correctMarker(){return t(X)},set correctMarker(e){a(X,e)},get correctLocation(){return t(I)},set correctLocation(e){a(I,e)},get guessed(){return t(x)},set guessed(e){a(x,e)},$$legacy:!0}),e=>a(y,e),()=>t(y));var G=c(V,2);{var J=e=>{var o=Qt(),u=r(o),D=r(u),M=r(D,!0);s(D),s(u);var d=c(u,2);Lt(d),s(o),$(()=>Y(M,t(k))),jt(d,()=>t(k),P=>a(k,P)),h(e,o)},rt=e=>{var o=Ut(),u=r(o),D=r(u);s(u);var M=c(u,2),d=r(M),P=r(d);s(d);var it=c(d,2),xt=r(it);s(it),s(M);var nt=c(M,2),st=r(nt),vt=c(r(st),2),bt=r(vt,!0);s(vt),s(st);var lt=c(st,2),ut=c(r(lt),2),wt=r(ut,!0);s(ut),s(lt);var dt=c(lt,2),ct=c(r(dt),2),Mt=r(ct,!0);s(ct),s(dt),s(nt),s(o),$(()=>{Y(D,`Kaugus õigest asukohast: ${t(g)??""} km`),Y(P,`Pakutud aasta: ${t(k)??""}`),Y(xt,`Õige aasta: ${n[t(m)-1].year??""}`),Y(bt,t(A)),Y(wt,t(b)),Y(Mt,t(A)+t(b))}),h(e,o)};q(G,e=>{t(x)?e(rt,!1):e(J)})}var N=c(G,2),ht=r(N);{var pt=e=>{var o=Vt();h(e,o)},_t=e=>{var o=Pt(),u=mt(o);{var D=d=>{var P=Gt();R("click",P,Z),h(d,P)},M=d=>{var P=Jt();R("click",P,L),h(d,P)};q(u,d=>{t(x)?d(M,!1):d(D)})}h(e,o)};q(ht,e=>{t(v)?e(_t,!1):e(pt)})}s(N),s(S),s(j),h(i,j)};q(C,i=>{i(O,!1)})}h(F,l),Dt()}export{fe as component,ce as universal};
